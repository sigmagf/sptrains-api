# Migration `20200907171808-add-link-table`

This migration has been generated by Joao Gabriel at 9/7/2020, 2:18:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."_LineToStation" DROP CONSTRAINT "_LineToStation_A_fkey"

ALTER TABLE "public"."_LineToStation" DROP CONSTRAINT "_LineToStation_B_fkey"

CREATE TABLE "public"."LineStationOrder" (
"id" text   NOT NULL ,
"order" integer   NOT NULL ,
"lineId" text   NOT NULL ,
"stationId" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."LineStationOrder" ADD FOREIGN KEY ("lineId")REFERENCES "public"."Line"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."LineStationOrder" ADD FOREIGN KEY ("stationId")REFERENCES "public"."Station"("id") ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE "public"."_LineToStation"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200907171433-initial..20200907171808-add-link-table
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -20,9 +20,9 @@
   number     Int        @unique
   name       String     @unique
   color      String
   active     Boolean?   @default(true)
-  stations   Station[]
+  stations   LineStationOrder[]
   companyId  String
   createdAt  DateTime   @default(now())
   updatedAt  DateTime   @default(now()) @updatedAt
@@ -33,8 +33,17 @@
   id           String    @id
   displayName  String
   fullName     String    @unique
   elevator     Boolean?  @default(false)
-  lines        Line[]
   createdAt    DateTime  @default(now())
   updatedAt    DateTime  @default(now()) @updatedAt
+}
+
+model LineStationOrder {
+  id         String   @id
+  order      Int
+  lineId     String
+  stationId  String
+
+  line       Line     @relation(fields: [lineId], references: [id])
+  station    Station  @relation(fields: [stationId], references: [id])
 }
```


